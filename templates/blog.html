{% load static %}
{% load humanize %}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{content.title}}</title>
    <link rel="shortcut icon" href={% static './image/icon.png'%} type="image/x-icon" />
    <!-- bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous" />
    <!-- icon -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" />

    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <style>
        * {
            font-family: sans-serif;
        }

        nav {
            box-shadow: none;
            position: sticky;
            top: 0;
            transition: 1s ease;
            min-width: 100%;
            z-index: 1;
        }
        .bi{
            font-size: 2rem;
        }

        .nav-wrapper {
            background-color: rgb(0, 0, 0);
        }

        nav ul a:hover {
            background-color: transparent;
            color: #c700ff;
            font-size: bold;
        }
        .auther_img{
            width: 3.5rem;
            height: 3.5rem;
        }

        header { 
            background: url("/media/{{content.blog_catagory.bg}}");
            background-size: cover;
            background-position: center;
            min-height: 200px;
        }

        .fr-fil.fr-dib,.fr-fic.fr-dii{
            width: 100%;
            height: auto;
        }
        #newsCard{
            position: unset;
            background-color: #eaeaea;
            padding: 0.1rem;
            margin: 0rem 1rem;
            border: 0px;
            border-radius: 2px;
            box-shadow: 0px 0px black;
            width: 18rem;
        }
        #newsCard:hover{
            box-shadow: 1px 3px 10px #bdb5b5;
        }    
        
        .card {
            position: unset;
            background-color: #0000004a;
            padding: 1rem;
            margin-top: 2rem;
            border-radius: 4px;
        }
        #cardTitle{
            margin: 0.5rem 0rem 0.75rem 0rem;
            color: rgb(0, 0, 0);
            font-weight: bolder;
        }
        .truncate2{
            overflow: hidden;
        
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-line-clamp: 4;
        }
        #dropdown1 {
            height: auto;
            overflow: hidden;
            padding: 0.4rem;
            border-radius: 2px;
        }
        .blog_img{
            width: 90%;
        }
        .bodycontainer{
            width:60%;
        }
        .mainHeader{
            margin:0px;
            font-size:40pt;
            font-weight:500;
        }
        .input-field .prefix.active{
            color:black;
        }
        .titleDiscription{
            font-size:16pt;
            font-weight:2pt;
            position:unset;
            color: #000000bf;
        }
        @media screen and (max-width: 900px){
            .bodycontainer{
                width:90%;
            }
            .mainHeader{
                margin:0px;
                font-size:35pt;
                font-weight:500;
            }
        }

        @media screen and (max-width: 700px) {
            nav .brand-logo {
                font-size: 1.5rem;
            }
            .fr-fil.fr-dib,.fr-fic.fr-dii{
                width: 100%;
                height: auto;
            }
            iframe {
                width: 100%;
            }
            .title{
                font-size: 2rem;
            }
            header{
                min-height: 11rem;
            }
            .blog_img{
                width: 100%;
            }
            img {
                max-width: 100%;
                height: auto;
                display: block;
                margin-left: auto;
                margin-right: auto;
            }
            h2 {
                font-size: 2.56rem;
            }
            p{
                overflow: hidden;
            }
            .bodycontainer{
                width:95%;
            }
            .mainHeader{
                margin:0px;
                font-size:30pt;
                font-weight:500;
            }
            .titleDiscription{
                font-size:14pt;
                font-weight:2pt;
                position:unset;
                color: #000000bf;
            }
        }
    </style>
</head>

<body>
    <!-- nav  -->
    <nav class="nav-wrapper">
        <div class="container">
            <a href="/" class="brand-logo">REPUBLIC KTM</a>
            <a href="#" class="sidenav-trigger" data-target="mobile-menu">
                <i class="bi bi-list"></i>
            </a>
            <ul class="right hide-on-med-and-down">
                <li><a href="/blog">Blog</a></li>
                <li><a href="/service">Services</a></li>
                <li><a href="/contact">Contact</a></li>
                {% if user.is_superuser %}
                    <a href="/republic_ktm_4912/" class="waves-effect waves-purple btn white black-text"><i class="bi bi-bar-chart-fill left"></i><b>Admin</b></a>
                {% endif %}
                
                {% if user.is_authenticated %}
                    <!--
                    <a type="submit" href="/register/logout" class="waves-effect waves-dark btn white black-text">
                        <b>Logout</b>
                    </a>-->
                    <!-- Dropdown Trigger -->
                    <a class='dropdown-trigger btn waves-effect waves-purple btn white black-text' href='#' data-target='dropdown1'><b>{{user}}</b></a>
 
                    <!-- Dropdown Structure -->
                    <ul id='dropdown1' class='dropdown-content' >
                        <li style="min-height:30px;"><a class='center' href="/history/{{user.id}}" style="padding:0; color:black; height:30px;"><b>History</b></a></li>
                        <li style="min-height:30px;"><a class='center' href="/register/logout" style="padding:0; color:red; height:30px;"><b>Logout</b></a></li>
                    </ul>
                {% else %}
                    <a type="submit" href="/register" class="waves-effect waves-purple btn white black-text">
                        <b>Sign In</b>
                    </a>
                {% endif %}
            </ul>
            
        </div>
    </nav>
    <!-- for small screen menu -->
    <ul class="sidenav grey lighten-2" id="mobile-menu">
        <li><a href="/blog">Blog</a></li>
        <li><a href="/service">Services</a></li>
        <li><a href="/contact">Contact</a></li>
        <li><a href="/admin">Admin</a></li>
        <div class="container">
            {% if user.is_authenticated %}
                <li><a href="">Hello,{{user}}</a></li><br/>
                <a type="submit" href="/register/logout" class="waves-effect waves-purple btn white black-text">
                    <b>Logout</b>
                </a>
            {% else %}
                <a type="submit" href="/register" class="waves-effect waves-purple btn white black-text">
                    <b>Sign In</b>
                </a>
            {% endif %}
        </div>
    </ul>
    <!-- header -->
    <header>
        <div class="container center" style="padding: 4rem 0vh;">
            <div><h2 class="text-white" style="margin:0px; text-shadow: 1px 1px black;">{{content.blog_catagory.title}}</h2></div>
        </div>
    </header>
    {% for tag in posts.tags.all %}
        <div>
            <h1>{{tag.tag_name}}</h1>
        </div>
    {% endfor%}
    <!-- body --> 
    <div class="container bodycontainer">
        <!-- blog title --> 
        <div class="" style="padding: 1rem 0vh;">
            <div class="d-flex justify-content-between">
                <div class="p-2">
                    <a>{{content.blog_catagory.title}}</a><br><br>
                </div>
                <div class="right">
                    {% if user.is_superuser %}
                        <a style="margin-left:2rem; position:unset;" href="/republic_ktm_4912/bloggingPage/blogfield/{{content.sno}}/change/" class="waves-effect waves-light btn black white-text"><i class="bi bi-pencil-fill left"></i><b>Edit</b></a>
                    {% endif %}
                </div>
            </div>
            <h1 class="mainHeader">{{content.title}}</h1><br>
            <p class="titleDiscription"> {{content.discription}} </p>
        </div>
        <!-- auther body --> 
        <div class=""> 
                <hr>
                <div class="row">
                    <div class="col-sm-auto">
                        <div class="d-flex bd-highlight mb-3">
                            <div href="" class="p-2 bd-highlight">
                                <img  src="/media/{{content.author.img}}" alt="" class="circle responsive_img auther_img">
                            </div> 
                            <div class="p-2 bd-highlight" style="line-height: initial;">
                                <a href="/blog/auther/{{content.author.name}}" style="color:black;"> <b>{{content.author.name}}</b></a><br>
                                <a>{{content.position}}</a><br>
                                <a>{{content.date}}</a><br>
                            </div>
                        </div>
                    </div>
                    <div class="col"></div>
                    <div class="col-sm-auto">
                        {% autoescape on %}
                            {% with "http://google.com" as host %}
                                {% with "Share in" as share_txt %}

                                    {% with "twitter" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://twitter.com/share?url={{ host }}{{ page_url }}&amp;text={{ title }}" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-twitter"></i>
                                        </a>
                                    {% endwith%}

                                    {% with "facebook" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://www.facebook.com/share.php?u={{ host }}{{ page_url }}&amp;t={{ title }}" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-facebook"></i>
                                        </a>
                                    {% endwith %}

                                    {% with "linkedin" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://www.linkedin.com/shareArticle?mini=true&amp;url={{ host }}{{ page_url }}&amp;title={{ title }}&amp;ro=false&amp;summary=&amp;source=" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-linkedin"></i>
                                        </a>
                                    {% endwith %}

                                    {% with "instagram" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://www.instagram.com/share.php?u={{ title }}&amp;url={{ host }}{{ page_url }}" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-instagram"></i>
                                        </a>
                                    {% endwith %}

                                {% endwith %}
                            {% endwith %}
                        {% endautoescape %}
                        
                    </div>
                </div>
                <!-- <div class="d-flex bd-highlight mb-3">
                    <div href="" class="p-2 bd-highlight">
                        <img  src="/media/{{content.author.img}}" alt="" class="circle responsive_img auther_img">
                    </div> 
                    <div class="p-2 bd-highlight" style="line-height: initial;">
                        <a href="/blog/auther/{{content.author.name}}" style="color:black;"> <b>{{content.author.name}}</b></a><br>
                        <a>{{content.position}}</a><br>
                        <a>{{content.date}}</a><br>
                    </div>
                    <div class="ms-auto p-2 bd-highlight">
                        {% autoescape on %}
                            {% with "http://google.com" as host %}
                                {% with "Share in" as share_txt %}

                                    {% with "twitter" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://twitter.com/share?url={{ host }}{{ page_url }}&amp;text={{ title }}" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-twitter"></i>
                                        </a>
                                    {% endwith%}

                                    {% with "facebook" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://www.facebook.com/share.php?u={{ host }}{{ page_url }}&amp;t={{ title }}" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-facebook"></i>
                                        </a>
                                    {% endwith %}

                                    {% with "linkedin" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://www.linkedin.com/shareArticle?mini=true&amp;url={{ host }}{{ page_url }}&amp;title={{ title }}&amp;ro=false&amp;summary=&amp;source=" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-linkedin"></i>
                                        </a>
                                    {% endwith %}

                                    {% with "instagram" as service %}
                                        <a style="margin: 0.5rem; color: black;" href="http://www.instagram.com/share.php?u={{ title }}&amp;url={{ host }}{{ page_url }}" target="_blank" title="{{ share_txt }} {{ service }}">
                                            <i class="bi bi-instagram"></i>
                                        </a>
                                    {% endwith %}

                                {% endwith %}
                            {% endwith %}
                        {% endautoescape %}
                        {% comment %} <i class="bi bi-instagram"></i>&nbsp;&nbsp;&nbsp;
                        <i class="bi bi-facebook"></i>&nbsp;&nbsp;&nbsp;
                        <i class="bi bi-github"></i>&nbsp;&nbsp;&nbsp;
                        <i class="bi bi-youtube"></i> {% endcomment %}
                    </div>
                </div> -->
            </div>    
        </div>
        <!-- body -->
        <div class="container blogimg bodycontainer" >
            <div class="container center blog_img" style="width:100%">
                <img src="/media/{{content.display_img}}" alt="" style="width: 100%;">
                <a style="color: #000000a6;"><i>fig:{{content.display_img_caption}}</i></a>
                <br><br>
            </div>
            <div class="wrapper" style="min-width:100%;">
                {{content.content|safe}}
            </div> 
        </div>

        <!-- like -->
        <div>
            {% if user.is_authenticated %}
                {% if like.like %}
                    <div class="center">
                        <a style="margin-left:2rem; position:unset;" href="/history/removelike/{{content.slug}}/" class="waves-effect waves-light btn black white-text">
                            <i class="bi bi-heart-fill left"></i>
                            <b>{{content.like}} &nbsp like</b>
                        </a>
                    </div>
                {% else %}
                    <div class="center">
                        <a style="margin-left:2rem; position:unset;" href="/history/like/{{content.slug}}/" class="waves-effect waves-light btn black white-text">
                            <i class="bi bi-heart left"></i>
                            <b>{{content.like}} &nbsp like</b>
                        </a>
                    </div>
                {% endif %}
            {% else %}
                <!-- Modal Trigger -->
                <div class="center">
                    <a style="margin-left:2rem; position:unset;" href="#modal1" class="waves-effect waves-light btn black white-text modal-trigger">
                        <i class="bi bi-heart left"></i>
                        <b>{{content.like}} &nbsp like</b>
                    </a>
                </div>
                <!-- Modal Structure -->
                <div id="modal1" class="modal" style="height:auto;">
                    <div class="modal-content" style="border-bottom: 0px">
                        <h5>Login to like this post!!!</h5>
                    </div>
                    <div class="modal-footer">
                        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
                        <a href="/register/" class="modal-close waves-effect waves-green btn-flat">Login</a>
                    </div>
                </div>
            {% endif %}
        </div>

        <!-- comment -->
        {% comment %} <div class="container bodycontainer">
            
            <div>
                {% if user.is_authenticated %}
                    <br>
                    <ul class="collapsible">
                        <li class="container" style="width:95%">
                            
                            <form action="/blog/postComment" method="post" class="col s12">
                                <div class="row">
                                    <div class="input-field col s6">
                                        {% csrf_token %}
                                        <i class="material-icons prefix"><i class="bi bi-chat-left-dots"></i></i>
                                        <input id="icon_prefix" type="text" name="comment" required>
                                        <label for="icon_prefix">Comment Here</label>
                                        <input type="hidden" name="parentSno" value="">
                                        <input type="hidden" name="postSno" value="{{content.sno}}">
                                        <button type="submit" class="btn black white-text right" style="margin-top: 2rem;">
                                            <b>Submit</b>
                                        </button>
                                    </div>
                                </div>
                            </form>
                            {% for comment in comments %}
                                <form action="/blog/postComment" method="post">
                                    <a> {{comment.user}}: <b>{{comment.comment}}</b>&nbsp; &nbsp; &nbsp;{{comment.timestamp | naturaltime}} <br><a>
                                </form>
                            {% endfor %}
                            <br><br>
                        </li>
                    </ul>
                {% else %}
                    <h5> Comments </h5>
                    <hr>
                    {% for comment in comments %}
                        <a> {{comment.user}}: <b>{{comment.comment}}</b>&nbsp; &nbsp; &nbsp;{{comment.timestamp | naturaltime}} <br><a>
                    {% endfor %}
                    <hr>
                    <br><h5><i class="bi bi-exclamation-circle-fill left"></i> Login To Comment </h5>
                {% endif %}
            </div>
        </div> {% endcomment %}
        <div class="row d-flex justify-content-center container" style="width:100%">
            <div class="col-md-8 col-lg-8">
              <div class="card shadow-0 border" style="background-color: #fff;padding:0;">
                {% if user.is_authenticated %}
                    <div class="card-body p-4">
                        <h4>Comment Here</h4>
                        <form action="/blog/postComment" method="post" class="col s12">
                            <div class="row">
                                <div class="input-field col s6">
                                    {% csrf_token %}
                                    <grammarly-extension data-grammarly-shadow-root="true" style="mix-blend-mode: darken; position: absolute; top: 0px; left: 0px; pointer-events: none;" class="cGcvT"></grammarly-extension>
                                    <i class="material-icons prefix"><i class="bi bi-chat-left-dots"></i></i>
                                    <input id="icon_prefix" type="text" name="comment" spellcheck="true" required>
                                    <label for="icon_prefix">Comment Here</label>
                                    <input type="hidden" name="parentSno" value="">
                                    <input type="hidden" name="postSno" value="{{content.sno}}">
                                    <button type="submit" class="btn black white-text right" style="margin-top: 2rem;">
                                        <b>Submit</b>
                                    </button>
                                </div>
                            </div>
                        </form>
                        {% for comment in comments %}
                            <div class="card" style="background-color:#f0f2f5; padding:0;">
                                <div class="card-body" style="padding:1rem">
                                    <div class="d-flex justify-content-between" style="margin-bottom: 1rem;">
                                        <div class="d-flex flex-row align-items-center">
                                            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQTHTAJPlLEQwOQG_g-WNP0WayMmnpM-Nq9ZA&usqp=CAU" alt="avatar" width="25" height="25" />
                                            <p class="medium mb-0 ms-2">{{comment.user}}</p>
                                        </div>
                                        
                                        <div style="font-size:1rem; color:black">
                                            <a>{{comment.timestamp | naturaltime}}</a>
                                            {% if comment.user.id is user.id %}
                                                <!-- trigger for deleting comment  -->
                                                &nbsp;&nbsp;<a class="modal-trigger" href="#modal2"><i style="font-size:1.2rem;padding:0px;margin:0px;color:#e61818" class="bi bi-trash-fill right"></i></a>
                                                <div id="modal2" class="modal" style="height:auto;">
                                                    <div class="modal-content" style="border-bottom: 0px">
                                                        <h3>Delete this comment</h3>
                                                        <p> {{comment.comment}}</p>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <a href="#!" class="modal-close waves-effect waves-green btn-flat">Close</a>
                                                        <a href="/blog/deleteComment/{{comment.sno}}" class="modal-close waves-effect waves-red btn-flat">Delete</a>
                                                    </div>
                                                </div>
                                            {%endif%}
                                        </div>
                                    </div>
                                    <h6>{{comment.comment}}</h6>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% else %}
                <div class="card-body p-4">
                    <h4>Comments</h4>
                    <br><h5><i class="bi bi-exclamation-circle-fill left"></i> Login To Comment </h5><br>
                    {% for comment in comments %}
                        <div class="card" style="background-color:#f0f2f5; padding:0;">
                            <div class="card-body" style="padding:1rem">
                                <div class="d-flex justify-content-between" style="margin-bottom: 1rem;">
                                    <div class="d-flex flex-row align-items-center">
                                        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQTHTAJPlLEQwOQG_g-WNP0WayMmnpM-Nq9ZA&usqp=CAU" alt="avatar" width="25" height="25" />
                                        <p class="medium mb-0 ms-2">{{comment.user}}</p>
                                    </div>
                                    <a style="font-size:1rem; color:black">{{comment.timestamp | naturaltime}}</a>
                                </div>
                                <h6>{{comment.comment}}</h6>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
              </div>
            </div>
          </div>
    </div>
    <!-- recomendation card -->
    <div class="container">
        <div class="container center" style="width: 100%;">
            <h1 style="font-size: 3.5rem;">Related Post</h1>
            <hr>
        </div>
        <div class="wrapper" style="overflow-x: scroll;overflow-y: hidden;">
            <div class="item" style="height: auto; width:20rem; background-color: transparent; margin:5px; display:flex;">
                {% for blog in content.related_blog.all %}
                    {% if blog.publish == True %}
                        <div class="item" style="height: auto; width:20rem; background-color: transparent; margin:5px;">
                            <div class="card" id="newsCard">
                                <div style="position:unset;" class="card-image" >
                                    <img style="height: 11.5rem; border-radius: 2px; position:unset;" src="../media/{{blog.display_img}}">
                                </div>
                                <div class="card-body">
                                <h5 class="card-title truncate" id="cardTitle">{{blog.title}}</h5>
                                <p class="card-text truncate2">{{blog.discription}} </p>
                                <a href="/blog/{{blog.slug}}" class="btn btn-primary black" style="font-size: 1rem;">Read More</a>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        </div>

    </div>
    <!-- footer -->
    <footer class="page-footer black darken-3">
        <div class="container">
            <div class="row">
                <div class="col l6 s12">
                    <h5>The secret valley journal</h5>
                    <p>The things we do is not normal here</p>
                </div>
                <div class="col l4 offset-l2 s12">
                    <h5 class="white-text">Usefull Links</h5>
                    <a href="/blog" style="color:white;">Blog</a><br>
                    <a href="/contact" style="color:white;">Contact</a><br>
                    <a href="/service" style="color:white;">Services</a><br>  
                    <a href="" style="color:white;">hot news</a><br>
                </div>
                <div class="col l4 offset-l2 s12">
                    <h5 class="white-text">Contact Us</h5>
                    <a>Kathmandu, Nepal</a><br>
                    <a>contact@thesecretvaleyjournal.com</a><br>
                    <a>+977 987654321</a>
                </div>
            </div>
            <hr class="center" style="position: unset; width: 80%; height: 0.3vh; margin: 1rem auto;">
            <div class="d-flex justify-content-evenly" >
                <a href="https://instagram.com/" style="color:white;"><i class="bi bi-instagram"></i></a>
                <a href="https://facebook.com/" style="color:white;"><i class="bi bi-facebook"></i></a>
                <a href="https://github.com/" style="color:white;"><i class="bi bi-github"></i></a>
                <a href="https://youtube.com/" style="color:white;"><i class="bi bi-youtube"></i></a>
            </div>
            <div class="container">
                <div style="height: 1rem;"></div>
            </div>
        </div>

        <div class="footer-copyright black darken-4">
            <div class="container center-align">&copy; 2022 The Secret Valley Journal</div>
        </div>
    </footer>

    <!-- Compiled and minified JavaScript -->
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-beta/js/materialize.min.js"></script>
    <script>
        $(document).ready(function () {
            $(".sidenav").sidenav();
            $('.tooltipped').tooltip();
            $('.dropdown-trigger').dropdown();
            $('.collapsible').collapsible();
            $('.modal').modal();

        });
      //$(window).on('scroll',function () {
      //    if ($(window).scrollTop()) {
      //        $('nav').removeClass('transparent');
      //    } else{
      //        $('nav').addClass('transparent');
      //    }
      //});
    </script>
</body>

</html>